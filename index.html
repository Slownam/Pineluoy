<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Server Creater</title>
  <style>
    :root{
      --bg1:#6c5ce7;
      --bg2:#4f46e5;
      --accent:#8b5cf6;
      --btn:#7c3aed;
    }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#eef2ff}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .card{width:100%;max-width:720px;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));border-radius:16px;padding:22px;border:1px solid rgba(255,255,255,0.06);box-shadow:0 10px 30px rgba(15,23,42,0.45)}
    h1{margin:0 0 8px;font-size:20px}
    p.lead{margin:0 0 18px;color:rgba(226,232,255,0.9)}
    label{display:block;font-weight:700;margin-top:10px;font-size:13px;color:#eef2ff}
    input,select{width:100%;padding:12px 14px;margin-top:8px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#c7d2fe;outline:none;font-size:14px}
    .actions{display:flex;gap:12px;align-items:center;margin-top:16px}
    .btn{background:linear-gradient(90deg,var(--btn),#5b21b6);color:white;padding:12px 16px;border-radius:12px;border:0;font-weight:700;cursor:pointer}
    .btn:disabled{opacity:0.6;cursor:not-allowed}
    .muted{color:rgba(226,232,255,0.8);font-size:13px}
    .result{margin-top:18px;background:rgba(255,255,255,0.03);padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
    pre{white-space:pre-wrap;word-wrap:break-word;color:#e6eef8;background:transparent;border:0;margin:0}
    .cred{font-size:14px;color:#c7d2fe;margin-bottom:8px}
    .loader{width:36px;height:36px;border-radius:50%;border:4px solid rgba(255,255,255,0.12);border-top-color:var(--accent);animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .footer{margin-top:12px;color:rgba(226,232,255,0.6);font-size:12px}
    @media (max-width:560px){.actions{flex-direction:column;align-items:stretch}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Create Server</h1>
      <p class="lead">Isi nama server & pilih paket RAM.</p>

      <form id="form">
        <label for="name">Nama (username / nameserver)</label>
        <input id="name" name="name" placeholder="contoh: lfstar" required autocomplete="off" />

        <label for="package">Pilih Paket RAM</label>
        <select id="package" name="package">
          <option value="1gb">1GB</option>
          <option value="2gb">2GB</option>
          <option value="3gb">3GB</option>
          <option value="4gb">4GB</option>
          <option value="5gb">5GB</option>
          <option value="6gb">6GB</option>
          <option value="7gb">7GB</option>
          <option value="8gb">8GB</option>
          <option value="9gb">9GB</option>
          <option value="10gb">10GB</option>
          <option value="unlimited">Unlimited</option>
          <option value="unli">Unli</option>
        </select>

        <div class="actions">
          <button id="btn" class="btn" type="submit">Buat Server</button>
          <div id="statusArea" class="muted">&nbsp;</div>
        </div>
      </form>

      <div id="resultBox" class="result" style="display:none">
        <div id="localCreds" class="cred"></div>
        <div id="loading" style="display:none;align-items:center;gap:12px"><div class="loader"></div><div class="muted">Sedang memproses... tunggu sebentar</div></div>
        <pre id="apiResp">-</pre>
      </div>

      <div class="footer">Di Buat Dengan ❤ - ©Lfstar.</div>
    </div>
  </div>

<script src="settings.js"></script>
<script>
  const VS_BASE = 'https://apiz.vsunsee.sbs/vsunseeV8/create';
  const DomainVal = (window.Domain || '').replace(/\/$/,'');
  const apikeyPtero = window.ptla || '';
  const capikeyPtero = window.ptlc || '';
  const useRootAdmin = !!window.rootadmin;

  const resourceMap = {
    "1gb":  { ram: 1000,  disk: 1000,  cpu: 40 },
    "2gb":  { ram: 2000,  disk: 1000,  cpu: 60 },
    "3gb":  { ram: 3000,  disk: 2000,  cpu: 80 },
    "4gb":  { ram: 4000,  disk: 2000,  cpu: 100 },
    "5gb":  { ram: 5000,  disk: 3000,  cpu: 120 },
    "6gb":  { ram: 6000,  disk: 3000,  cpu: 140 },
    "7gb":  { ram: 7000,  disk: 4000,  cpu: 160 },
    "8gb":  { ram: 8000,  disk: 4000,  cpu: 180 },
    "9gb":  { ram: 9000,  disk: 5000,  cpu: 200 },
    "10gb": { ram:10000,  disk: 5000,  cpu: 220 },
    "unlimited": { ram: 0, disk: 0, cpu: 0 },
    "unli":      { ram: 0, disk: 0, cpu: 0 }
  };

  function rand3(){ return String(Math.floor(Math.random()*900)+100); }
  function sanitize(u){ return u.trim().toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9-_\.]/g,''); }

  const form = document.getElementById('form');
  const btn = document.getElementById('btn');
  const statusArea = document.getElementById('statusArea');
  const resultBox = document.getElementById('resultBox');
  const apiResp = document.getElementById('apiResp');
  const loading = document.getElementById('loading');
  const localCreds = document.getElementById('localCreds');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    if(!DomainVal){ alert('settings.js: Domain belum diisi'); return; }
    if(!apikeyPtero){ alert('settings.js: ptla (apikey ptero) belum diisi'); return; }

    const raw = document.getElementById('name').value || '';
    if(!raw.trim()){ alert('Isi nama dulu'); return; }
    const pkg = document.getElementById('package').value || '1gb';
    const map = resourceMap[pkg] || resourceMap['unlimited'];

    const username = sanitize(raw);
    const email = username + '@gmail.com';
    const password = username + rand3();
    const nameserver = username;

    localCreds.innerHTML = `<strong>Email:</strong> ${email} &nbsp; <strong>Password:</strong> ${password} &nbsp; <strong>Nameserver:</strong> ${nameserver}`;
    resultBox.style.display = 'block';
    apiResp.textContent = '';
    loading.style.display = 'flex';
    btn.disabled = true;
    statusArea.textContent = 'Mengirim...';

    try{
      const params = new URLSearchParams({
        domain: DomainVal,
        apikeyptero: apikeyPtero,
        capikeyptero: capikeyPtero,
        nameserver: nameserver,
        password: password,
        disk: String(map.disk),
        cpu: String(map.cpu),
        rootadmin: String(useRootAdmin)
      });

      const url = VS_BASE + '?' + params.toString();
      const res = await fetch(url, { method: 'GET', headers: { 'Accept':'application/json' } });
      const text = await res.text();

      // langsung tampilkan hasil API (apa adanya)
      apiResp.textContent = text;
      statusArea.textContent = res.ok ? 'Selesai' : `Selesai (HTTP ${res.status})`;
    } catch(err){
      apiResp.textContent = 'Request error: ' + err.message;
      statusArea.textContent = 'Gagal';
    } finally{
      loading.style.display = 'none';
      btn.disabled = false;
    }
  });
</script>
</body>
</html>